# Wireless attacks

## Wireless Terminology

### GSM

- **GSM** - Global System for Mobile Communications

- It is the universal system used for mobile transportation of wireless networks worldwide.

- **GSM** is a second-generation (2G) standard employing time-division multiple- access (TDMA) spectrum-sharing, issued by the European Telecommunications Standards Institute (ETSI).

### Access Point (AP)

- **Access Point (AP)** - A device that allows wireless devices to connect to a wired network using Wi-Fi, or related standards.

### BSSID

- **BSSID** - Basic Service Set Identifier

- A BSSID is the MAC address of the wireless access point (WAP) generated by combining the 24-bit Organization Unique Identifier (OUI) and the manufacturer's assigned 24-bit identifier for the radio chipset in the WAP.

### ISM Band

- **ISM Band** - Industrial, Scientific, and Medical Band

- The ISM band is a group of radio frequencies reserved for industrial, scientific and medical purposes.

- The ISM band is defined by the ITU-R in 5.138, 5.150, and 5.280 of the Radio Regulations.

### Hotspot

- **Hotspot** - A physical location where people may obtain Internet access, typically using Wi-Fi technology, via a wireless local area network (WLAN) using a router connected to an Internet service provider.

### Association

- **Association** - The process by which a wireless client and an access point establish a connection.

### MIMO-OFDM

- **MIMO-OFDM** - Multiple Input Multiple Output - Orthogonal Frequency Division Multiplexing

- MIMO-OFDM is a combination of MIMO and OFDM technologies.

- MIMO is a technology that uses multiple antennas to coherently resolve more information than possible using a single antenna.

- An air interface for 4G and 5G broadband wireless access.

### SSID

- **SSID** - Service Set Identifier

- An SSID is a case sensitive, 32 alphanumeric character identifier.

- It is used to identify a wireless network.

### DSSS

- **DSSS** - Direct Sequence Spread Spectrum

- DSSS is a method of transmitting radio signals by rapidly switching a carrier among many frequency channels, using a pseudorandom sequence known to both transmitter and receiver.

### FHSS

- **FHSS** - Frequency Hopping Spread Spectrum

- FHSS is a method of transmitting radio signals by rapidly switching a carrier among many frequency channels, using a pseudorandom sequence known to both transmitter and receiver.

### OFDM

- **OFDM** - Orthogonal Frequency Division Multiplexing

- OFDM is a method of encoding digital data on multiple carrier frequencies.

### Wifi

- **Wifi** - Wireless Fidelity

- Wifi refers to WLANs based on IEEE 802.11 standard, which allows the devices to access the network from anywhere within an AP range.

## Wireless Encryption

### 802.11

- **802.11** - A set of IEEE standards that govern wireless networking transmission methods.

- An IEEE standard for wireless networking that specifies the physical layer and the media access control (MAC) layer protocols.

### WEP

- **WEP** - Wired Equivalent Privacy

- WEP is a security protocol for wireless local area networks (WLANs).

- It is a security protocol defined by 802.11b standard to provide a wireless LAN with a level of security and privacy comparable to that of a wired network.

- WEP uses a 24-bit initialization vector (IV) to form stream cipher RC4 for confidentiality and the CRC-32 checksum for integrity of wireless transmission

- It has significant vulnerability and design flaws and can therefore be easily cracked.

### WPA

- **WPA** - Wi-Fi Protected Access

- WPA is a security protocol for wireless local area networks (WLANs).

- It uses a Temporal Key Integrity protocol (TKIP) that utilizes the RC4 stream cipher encryption with 128 bit key and 64 bit MIC integrity check to provide stronger encrytion and authentication.

- WPA also includes per-packet mixing functions, message integrity checks, extended initialization vectors and re-keying mechanisms

### EAP

- **EAP** - Extensible Authentication Protocol

- EAP is an authentication framework frequently used in wireless networks and point-to-point connections.

- It supports multiple authentication methods like token cards, kerberos, and certificates.

### LEAP

- **LEAP** - Lightweight Extensible Authentication Protocol

- LEAP is a proprietary wireless LAN authentication method developed by Cisco Systems.

### TKIP

- **TKIP** - Temporal Key Integrity Protocol

- TKIP is a security protocol used in the IEEE 802.11 wireless networking standard.

### WPA2 Enterprise

- **WPA2 Enterprise** - Wi-Fi Protected Access 2 Enterprise

- Integrates EAP standards with WPA2 encryption

- It includes EAP or RADIUS for centralized authentication using multiple authentication methods, such as token cards, or Kerberos

### CCMP

- **CCMP** - Counter Mode with Cipher Block Chaining Message Authentication Code Protocol

- An encryption protocol used in WPA2 for stronger encryption and authentication

### AES

- **AES** - Advanced Encryption Standard

- AES is a symmetric block cipher chosen by the U.S. government to protect classified information.

### WPA2 Personal

- **WPA2 Personal** - Wi-Fi Protected Access 2 Personal

- Uses AES and CCMP for wireless data encryption

- It uses a set-up password (pre-shared key, PSK) to protect unauthorized network access

### RADIUS

- **RADIUS** - Remote Authentication Dial-In User Service

- RADIUS is a networking protocol that provides centralized Authentication, Authorization, and Accounting (AAA) management for computers to connect and use a network service.

### PEAP

- **PEAP** - Protected Extensible Authentication Protocol

- PEAP is a protocol that encapsulates EAP within a secure, encrypted TLS tunnel.

### WPA3

- **WPA3** - Wi-Fi Protected Access 3

- WPA3 is a security protocol for wireless local area networks (WLANs).

- Third generation Wi-fi security protocol that used GCMP-256 encryption and HMAC-SHA-384 authentication.

## Wireless Attacks

### Rogue Access Point

- **Rogue Access Point** - A wireless access point that has been installed on a secure network without explicit authorization from a local network administrator, whether added by a well-meaning employee or by a malicious attacker.

- A rogue AP is placed into the 802.11 network can be used to hijack the network connections

- When the user turns on the computer, the rogue wireless AP will offer to connect with the network user's NIC

- All the traffic the user enters will pass through the rogue AP, thus enabling a form of wireless packet sniffer.

- Attacker setup Rogue AP outside the corporate parameter and lures the employees of the organization to connect to the rogue AP.

- Once associated, attacker can bypass the enterprise security policy. 

- This is called Client Mis-Association Attack.

### Misconfigured AP

- APs are configured to broadcast SSIDs to authorized users.

- OR the network administrator incorrectly uses SSIDs as passwords

- SSID broadcast is a configuration error that enables intruders to steal an SSID and cause the AP assume they are allowed to connect


### Unauthorized Association

- Soft APs are client cards or embedded VLAN radios in some PDAs and laptops that can be launched inadvertently or through a virus program

- Attackers infect a victim's machine and activate soft APs, thus allowing them unauthorized connection to enterprise network

- Attacker connect to enterprise networks through Soft APs instead of actual APs

### Ad-Hoc Connection Attack

- Ad-Hoc Connection is a direct connection between two wireless clients without the use of an AP

- An ad-hoc connection is a temporary network connection that is formed for the purpose of sharing data

- It is inherently insecure because it does not use an access point

### AP MAC Spoofing

- MAC spoofing is a technique for changing a factory-assigned Media Access Control (MAC) address of a network interface on a networked device.

- Hacker spoofs the MAC address of WLAN Client equipment to mask as an authorized client

- Attacker connects to AP as an authorized client and eavastraps the network

### Key re-installation attack (KRACK)

- KRACK is a vulnerability in the WPA2 protocol that allows an attacker to decrypt wireless network traffic.

- All secure WiFi networks use the 4-way handshake process to join the network and generate a fresh encryption key that will be used to encrypt the network traffic.

- The KRACK attack works by exploiting the 4-way handshake of the WPA2 protocol by forcing Nonce reuse

- KRACK works against all modern protected WiFi networks and allows the attacker to steal sensitive information, such as credit cards, passwords etc.

### Jamming Signal Attack

- All wireless networks are prone to jamming

- The jamming signal causes a DoS because 802.11 is a CSMA/CA protocol whose collision avoidance algorithms require a period of silence before a radio is allowed to transmit.

- Attacker stakes out the area from a nearby location with a high-gain amplifier drowning out the legimitate AP.

### Cracking WEP using Aircrack-ng

- Aircrack-ng is a network software suite consisting of a detector, packet sniffer, WEP and WPA/WPA2-PSK cracker and analysis tool for 802.11 wireless LANs.

- Run airmon-ng in monitor mode

- Start airodump to discover SSIDs on interface and keep it running, your capture file should contain more than 50,000 IVs to successfully crack the WEP key.

- Associate your wireless card with target AP

- Inject packets using airplay-ng to generate traffic on the target AP

- Wait for airodump-ng to capture more than 50,000 IVs, crack WEP key using aircrack-ng

### Cracking WPA-PSK using Aircrack-ng

- Monitor wireless traffic with airmon-ng

- `C:/>airmon-ng start eth1`

- Collect wireless traffic data with airodump-ng

- `airodump-ng --write capture eth1`

- Deauth the client using airplay-ng, the client will try to authenticate with the AP, which will lead to airodump capturing authentication packet

- `aireplay-ng --deauth 11 -a [MAC_ADDRESS]`

- Run the captured file through aircrack-ng

- `aircrack-ng -a 2 capture.cap`

## Wireless cracking tools

- [Aircrack-ng](https://www.aircrack-ng.org/) : Aircrack-ng is a network software suite consisting of a detector, packet sniffer, WEP and WPA/WPA2-PSK cracker and analysis tool for 802.11 wireless LANs.

- [Airbase-ng](https://www.aircrack-ng.org/doku.php?id=airbase-ng) : Airbase-ng allows you to configure and manage fake access points. It captures WPA/WPA2 handshake and can act as ad-hoc AP

- [airdecap-ng](https://www.aircrack-ng.org/doku.php?id=airdecap-ng) : Airdecap-ng is used to decrypt WEP/WPA/WPA2 capture files and can be used to strip the wireless headers from the WiFi packets.

- [airgraph-ng](https://www.aircrack-ng.org/doku.php?id=airgraph-ng) : Airgraph-ng is a tool that can be used to create graphs from the output of Aircrack-ng.

- [airmon-ng](https://www.aircrack-ng.org/doku.php?id=airmon-ng) : Airmon-ng is used to enable and disable monitor mode on wireless interfaces.

- [airtun-ng](https://www.aircrack-ng.org/doku.php?id=airtun-ng) : Airtun-ng is used to create virtual tunnels with wireless cards that support raw injection.

- [easside-ng](https://www.aircrack-ng.org/doku.php?id=easside-ng) : Easside-ng is a tool that automates the creation of a WEP key from captured WEP packets.

- [packetforge-ng](https://www.aircrack-ng.org/doku.php?id=packetforge-ng) : Packetforge-ng is used to create encrypted packets for injection. These packets can be used for injection.

- [airdecloak-ng](https://www.aircrack-ng.org/doku.php?id=airdecloak-ng) : Airdecloak-ng is used to remove WEP cloaking from captured packets.

- [airdrop-ng](https://www.aircrack-ng.org/doku.php?id=airdrop-ng) : Airdrop-ng is used to test injection on wireless drivers and cards.

- [aireplay-ng](https://www.aircrack-ng.org/doku.php?id=aireplay-ng) : Aireplay-ng is used to inject frames. It has many attack vectors.

- [wesside-ng](https://www.aircrack-ng.org/doku.php?id=wesside-ng) : Wesside-ng is used to recover WEP keys from WEP encrypted traffic.

- [airodump-ng](https://www.aircrack-ng.org/doku.php?id=airodump-ng) : Airodump-ng is used for packet capturing of raw 802.11 frames and is particularly suitable for collecting WEP IVs (Initialization Vector) for the intent of using them with aircrack-ng.

- [airolib-ng](https://www.aircrack-ng.org/doku.php?id=airolib-ng) : Airolib-ng is used to store and manage essid and password lists.

- [airserv-ng](https://www.aircrack-ng.org/doku.php?id=airserv-ng) : Airserv-ng is used to create a virtual access point using a wired interface.

- [tkiptun-ng](https://www.aircrack-ng.org/doku.php?id=tkiptun-ng) : Tkiptun-ng is used to inject frames into WPA TKIP encrypted networks.

- [wzcook](https://www.aircrack-ng.org/doku.php?id=wzcook) : Wzcook is used to recover WEP keys from WEP encrypted traffic.

- [airMagnet](https://www.netscout.com/products/airmagnet-wifi-analyzer) : AirMagnet WiFi Analyzer is the industry standard tool for mobile auditing and troubleshooting enterprise WiFi networks.

## Bluetooth Suite

- Bluetooth is a short-range wireless communication technology that replaces the cables connecting portable and fixed devices while maintaining high level of security.

- It allows the devices to share data over short range.

### Bluetooth modes

- Discoverable modes :

    - Discoverable :  Sends inquiry responses to all inquiry requests.

    - Limited discoverable : Visible for a certain period of time

    - Non-Discoveable : Not visible to other devices

- Pairing modes :

    - Non-pairable mode : Rejects every pairing requests

    - Pairable mode : pairs upon request

### Bluetooth Hacking

- Bluetooth hacking refers to the exploitation of Bluetooth stack implementation vulnerabilities in order to compromise sensitive data in Bluetooth-enabled devices.

- Some bluetooth hacking attacks are :

    - Bluesmacking  : DoS attack, which overflows Bluetooth-enabled devices with random packets, causes the devices to crash

    - Bluejacking : The art of sending unsolicited messages over Bluetooth to Bluetooth-enabled devices, such as mobile phones and laptops.

    - Bluesnarfing : The theft of information from a wireless device through a Bluetooth connection, often between phones, desktops, laptops, and PDAs.

    - Bluesniff : The process of finding discoverable and non-discoverable Bluetooth devices and their services.

    - Bluebugging : The process of taking control of a Bluetooth-enabled device through the use of commands sent by another Bluetooth device. i.e. Remotely accessing it.

    - Blueprinting : The process of gathering as much information as possible about a Bluetooth-enabled device, including its address, name, class, supported services, and any other information that can be obtained.

    - Btlejacking : The process of taking control of a Bluetooth Low Energy (BLE) device through the use of commands sent by another Bluetooth device.

    - KNOB Attack : The KNOB attack exploits a vulnerability in the Bluetooth specification that allows an attacker to reduce the length of an encryption key used on a Bluetooth connection. It lets the attacker to eavesdrop on all encrypted Bluetooth traffic exchanged between two vulnerable devices.

    - MAC Spoofing : Intercepting data intended for other Bluetooth device.

    - Man-in-the-Middle Attack : The attacker intercepts communication between two Bluetooth devices by secretly relaying and possibly altering the communication between the two devices.

### Bluetooth Threats

- Leakage of Calendars and Address Books - Attacker can steal a user's personal information and use it for malicious purposes.

- Sending SMS Messages : Text messages can be sent to the victim's contacts.

- Bugging Devices : Attacker could instruct the user to make a phone call to other phones without any usre interaction, they can even record calls.

- Causing Financial losses : Hackers could send messages to premium rate numbers.

- Remote Control : Attacker can take control of the device and use it for malicious purposes.

- Social Engineering : Attackers trick bluetooth users to lower their guard and accept malicious files.

- Malicious Code : Attackers can send malicious code to the victim's device.

- Protocol Vulnerabilities : Attackers can exploit vulnerabilities in the bluetooth protocol stack. This may lead to stealing data, making calls, sending messages, conduct DoS, start phone spying and more.

### Bluetooth Attack Tools

- [BluetoothView](https://www.nirsoft.net/utils/bluetooth_viewer.html) : BluetoothView is a small utility that runs in the background, and monitor the activity of Bluetooth devices around you.

- [bluez](http://www.bluez.org/) : BlueZ is the official Linux Bluetooth stack.

- [btcrawler]()

- [bluescan]()

## Wireless Attacks Countermeasures

- Change the defauly SSID after WLAN configuration.
- Set the router access password and enable firewall protection
- Disable SSID broadcast
- Disable remote router login and wireless administration
- Use SSID cloaking to keep certain default wireless messages from broadcasting the IDs to everyone
- Do not use your SSID, company name, network name, or any easy to guess string as password
- Place a firewall or packet filter between the AP and the coorporate intranet
- Choose Enterprise WPA2 with 802.1x authentication instead of WPA or WEP
- Implement WPA2/WPA3 Enterprise wherever possible
- Disable network when not required
- Place wireless APs in a secure location

### Bluetooth Attack Countermeasures

- Use non-regular patterns as PIN keys when pairing devices
- Keep your devices in non-discoverable mode
- Do Not accept any unknown and unexpected pairing requests
- Always enable encryption when establishing BT connection to your PC
- Keep a check of all paired devices in the past from time to time and delete any paired device that you do not recognize
- Keep the BT in disabled state, and enable it only when needed.

## Wireless Security Tools

- [Cisco Adaptive Wireless IPS](https://www.cisco.com/c/en/us/products/wireless/adaptive-wireless-ips/index.html) : Cisco Adaptive Wireless IPS is the industry’s first comprehensive solution that allows you to detect, classify, locate, and mitigate threats over the air—securing the air space from wireless threats and eliminating the need for expensive overlay security systems and sensor hardware deployments.

- [AirMagnet WiFi Analyzer](https://www.netscout.com/products/airmagnet-wifi-analyzer) : AirMagnet WiFi Analyzer is the industry standard tool for mobile auditing and troubleshooting enterprise WiFi networks.

- [RFProtect](https://www.arubanetworks.com/products/security/network-access-control/rfprotect/) : RFProtect is a wireless intrusion prevention system (WIPS) that detects and blocks wireless threats in real time.

- [Extreme AirDefense](https://www.extremenetworks.com/product/airdefense/) : Extreme AirDefense is a wireless intrusion prevention system (WIPS) that detects and blocks wireless threats in real time.